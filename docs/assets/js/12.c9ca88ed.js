(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{576:function(t,_,v){t.exports=v.p+"assets/img/AD9910.418cef1d.png"},577:function(t,_,v){t.exports=v.p+"assets/img/STMCTR.89f0908a.png"},578:function(t,_,v){t.exports=v.p+"assets/img/AD9910_E.ffe168ae.png"},579:function(t,_,v){t.exports=v.p+"assets/img/STMCTR_E.eb35b42c.png"},672:function(t,_,v){"use strict";v.r(_);var s=v(17),a=Object(s.a)({},(function(){var t=this,_=t.$createElement,s=t._self._c||_;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"概述"}},[t._v("概述")]),t._v(" "),s("p",[t._v("AOM的驱动信号及扫频控制信号由AD9910及其控制板提供，本文档旨在对硬件连接、软件使用作出基本说明。")]),t._v(" "),s("p",[s("img",{attrs:{src:v(576),alt:"AD9910"}})]),t._v(" "),s("p",[t._v("后面称为“核心板”")]),t._v(" "),s("p",[s("img",{attrs:{src:v(577),alt:"STMCTR"}})]),t._v(" "),s("p",[t._v("后面称为“控制板”")]),t._v(" "),s("h2",{attrs:{id:"硬件说明"}},[t._v("硬件说明")]),t._v(" "),s("h3",{attrs:{id:"核心板"}},[t._v("核心板")]),t._v(" "),s("p",[s("img",{attrs:{src:v(578),alt:"AD9910"}})]),t._v(" "),s("ol",[s("li",[s("p",[t._v("外部连接")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("通过左侧"),s("code",[t._v("DC-5V")]),t._v("连接到台式电源，提供5V供电")])]),t._v(" "),s("li",[s("p",[t._v("通过W1跳线帽（紫色方框）进行时钟源选择，跳线帽短接左侧两个引脚时为晶振提供时钟（推荐），短接右侧两个引脚时为外部时钟源（蓝色方框）")])]),t._v(" "),s("li",[s("p",[t._v("DDS输出为靠近核心板中间的SMA接头（红色方框）")])]),t._v(" "),s("li",[s("p",[t._v("通过下方排针与控制板连接（绿色方框）")])])])]),t._v(" "),s("li",[s("p",[t._v("注意事项")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("（重要）DDS输出含有约1.5V的直流成分， "),s("strong",[t._v("！！！必须！！！")]),t._v(" 连接隔直器后再接入后级设备")])]),t._v(" "),s("li",[s("p",[t._v("（重要）外部时钟源输入时，输入频率 "),s("strong",[t._v("！！！必须 ！！！")]),t._v(" 为40MHz，推荐信号幅值为0~3V，推荐信号类型为方波")])]),t._v(" "),s("li",[s("p",[t._v("（重要）"),s("strong",[t._v("注意与控制板的排线连接方向！！！没有防呆设计！！！连接错误可能直接烧掉芯片")]),t._v("，默认已经连接好")])]),t._v(" "),s("li",[s("p",[t._v("（推荐）上电前将模块开关（红色圆框）置于关闭状态")])]),t._v(" "),s("li",[s("p",[t._v("（不推荐）核心板出现输出异常时，直接通过开关断电重启核心板，这种硬件重置的方式只有在软件重置无效时才使用")])])])])]),t._v(" "),s("h3",{attrs:{id:"控制板"}},[t._v("控制板")]),t._v(" "),s("p",[s("img",{attrs:{src:v(579),alt:"STMCTR"}})]),t._v(" "),s("ol",[s("li",[s("p",[t._v("外部连接")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("通过右侧USB接口连接到上位机，上位机同时可以为模块提供5V供电，使用串口与上位机通信")])]),t._v(" "),s("li",[s("p",[t._v("通过左侧SMA接头（红色方框）与1pps时钟源连接")])]),t._v(" "),s("li",[s("p",[t._v("通过W1跳线帽（紫色方框）进行时钟源选择，跳线帽短接左侧两个引脚时为晶振提供时钟（推荐），短接右侧两个引脚时为外部时钟源（蓝色方框）")])]),t._v(" "),s("li",[s("p",[t._v("通过右上排针与核心板连接（绿色方框）")])])])]),t._v(" "),s("li",[s("p",[t._v("注意事项")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("（重要）外部1pps时钟输入幅值"),s("strong",[t._v("必须")]),t._v("大于1.8V（"),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",[s("semantics",[s("mrow",[s("msub",[s("mi",[t._v("V")]),s("mrow",[s("mi",[t._v("p")]),s("mi",[t._v("e")]),s("mi",[t._v("a")]),s("mi",[t._v("k")]),s("mo",[t._v("−")]),s("mi",[t._v("t")]),s("mi",[t._v("o")]),s("mo",[t._v("−")]),s("mi",[t._v("p")]),s("mi",[t._v("e")]),s("mi",[t._v("a")]),s("mi",[t._v("k")])],1)],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("V_{peak-to-peak}")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),s("span",{staticClass:"strut bottom",staticStyle:{height:"0.969438em","vertical-align":"-0.286108em"}}),s("span",{staticClass:"base textstyle uncramped"},[s("span",{staticClass:"mord"},[s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.22222em"}},[t._v("V")]),s("span",{staticClass:"vlist"},[s("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"-0.22222em"}},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),s("span",{staticClass:"reset-textstyle scriptstyle cramped"},[s("span",{staticClass:"mord scriptstyle cramped"},[s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mord mathit"},[t._v("e")]),s("span",{staticClass:"mord mathit"},[t._v("a")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),s("span",{staticClass:"mbin"},[t._v("−")]),s("span",{staticClass:"mord mathit"},[t._v("t")]),s("span",{staticClass:"mord mathit"},[t._v("o")]),s("span",{staticClass:"mbin"},[t._v("−")]),s("span",{staticClass:"mord mathit"},[t._v("p")]),s("span",{staticClass:"mord mathit"},[t._v("e")]),s("span",{staticClass:"mord mathit"},[t._v("a")]),s("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")])])])]),s("span",{staticClass:"baseline-fix"},[s("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[s("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])])])])]),t._v(")，为了避免意外噪声导致意外触发，建议输入幅值大于2V，蓝色方框处的蓝色LED灯在每次触发信号到来时会切换开关状态，作为时钟信号是否正常给到控制板的依据")])]),t._v(" "),s("li",[s("p",[t._v("（重要）注意与控制板的排线连接方向，"),s("strong",[t._v("有防呆设计，不要硬插")]),t._v("，默认已经连接好")])]),t._v(" "),s("li",[s("p",[t._v("（推荐）直接使用USB接口为模块供电，如果使用USB-HUB，需要注意HUB连接设备过多时，将USB-HUB连接上额外供电，"),s("code",[t._v("DC-5V")]),t._v("供电接口只在供电无法满足时才需要连接")])]),t._v(" "),s("li",[s("p",[t._v("（推荐）上电前将模块开关（右侧红色圆框）置于关闭状态")])]),t._v(" "),s("li",[s("p",[t._v("（推荐）核心板出现输出异常时，可以通过开关（左右侧红色圆框均可）断电重启控制板，达到软件重置核心板的效果")])]),t._v(" "),s("li",[s("p",[t._v("（不重要）核心板的"),s("code",[t._v("DC-5V")]),t._v("不要与控制板的"),s("code",[t._v("DC-5V")]),t._v("使用同一电源供电，以减小对DDS输出噪声的影响")])])])])]),t._v(" "),s("h3",{attrs:{id:"启动顺序"}},[t._v("启动顺序")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("按照外部连接说明连接核心板和控制板，检查模块开关均处于关闭状态（板卡上无红灯亮起）")])]),t._v(" "),s("li",[s("p",[t._v("打开台式电源供电开关")])]),t._v(" "),s("li",[s("p",[t._v("打开DDS模块开关（板上红灯亮起）")])]),t._v(" "),s("li",[s("p",[t._v("打开控制板模块开关（板上红灯亮起）")])])]),t._v(" "),s("h2",{attrs:{id:"软件配置"}},[t._v("软件配置")]),t._v(" "),s("h3",{attrs:{id:"相关文件"}},[t._v("相关文件")]),t._v(" "),s("p",[t._v("服务端："),s("a",{attrs:{href:"/files/AD9910/server_web.py"}},[t._v("server_web.py")])]),t._v(" "),s("p",[t._v("服务端依赖："),s("a",{attrs:{href:"/files/AD9910/requirements.txt"}},[t._v("requirements.txt")])]),t._v(" "),s("p",[t._v("客户端调用示例："),s("a",{attrs:{href:"/files/AD9910/client_web.py"}},[t._v("client_web.py")])]),t._v(" "),s("h3",{attrs:{id:"使用说明"}},[t._v("使用说明")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("下载依赖"),s("code",[t._v("requirements.txt")]),t._v("并使用pip安装依赖")])]),t._v(" "),s("li",[s("p",[t._v("（重要）程序运行前必须先确认已经正确连接控制板")])]),t._v(" "),s("li",[s("p",[t._v("运行服务端程序"),s("code",[t._v("server_web.py")]),t._v("，程序运行后会自动选择第一个设备描述中含有"),s("code",[t._v("STM")]),t._v("的串口进行连接通信")])]),t._v(" "),s("li",[s("p",[t._v("编写并运行客户端程序")])])]),t._v(" "),s("h3",{attrs:{id:"软件接口"}},[t._v("软件接口")]),t._v(" "),s("p",[s("code",[t._v("server_web.py")]),t._v("成功运行后，控制台会输出如下内容，表明服务端已经成功连接上控制板端口，并在"),s("code",[t._v("http://127.0.0.1:56789")]),t._v("监听客户端请求：")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("INFO:     Started server process "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xxxxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nINFO:     Waiting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" application startup.\nINFO:     Application startup complete.\nINFO:     Uvicorn running on http://127.0.0.1:56789 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Press CTRL+C to quit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[s("code",[t._v("client_web.py")]),t._v("中包含了所有接口的调用样例代码，以下是服务端的接口说明：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("功能")]),t._v(" "),s("th",[t._v("请求路径")]),t._v(" "),s("th",[t._v("请求类型")]),t._v(" "),s("th",[t._v("请求体内容")]),t._v(" "),s("th",[t._v("成功调用返回值")]),t._v(" "),s("th",[t._v("备注")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("测试指令")]),t._v(" "),s("td",[s("code",[t._v("/test/")])]),t._v(" "),s("td",[t._v("GET")]),t._v(" "),s("td",[t._v("无")]),t._v(" "),s("td",[s("code",[t._v('{"res": 1}')])]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("清空1pps序列")]),t._v(" "),s("td",[s("code",[t._v("/ctr/")])]),t._v(" "),s("td",[t._v("POST")]),t._v(" "),s("td",[s("code",[t._v('{"text": "SYS:TIME:CLR"}')])]),t._v(" "),s("td",[s("code",[t._v('{"res": "SYS:TIME:CLR"}')])]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("清空1pps序列")]),t._v(" "),s("td",[s("code",[t._v("/ctr/")])]),t._v(" "),s("td",[t._v("POST")]),t._v(" "),s("td",[s("code",[t._v('{"text": "SYS:TIME:GET?"}')])]),t._v(" "),s("td",[t._v("序列长度不足10时："),s("br"),s("code",[t._v('{"error": "now queue size n"}')]),s("br"),t._v("序列长度足够时："),s("br"),s("code",[t._v('["2024-01-23 01:23:45.123456", ...]')])]),t._v(" "),s("td",[t._v("序列长度不同时，返回类型不同")])]),t._v(" "),s("tr",[s("td",[t._v("扫频一级触发")]),t._v(" "),s("td",[s("code",[t._v("/ctr/")])]),t._v(" "),s("td",[t._v("POST")]),t._v(" "),s("td",[s("code",[t._v('{"text": "SYS:CURVE:START"}')])]),t._v(" "),s("td",[s("code",[t._v('{"res": "SYS:CURVE:START"}')])]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("结束扫频")]),t._v(" "),s("td",[s("code",[t._v("/ctr/")])]),t._v(" "),s("td",[t._v("POST")]),t._v(" "),s("td",[s("code",[t._v('{"text": "SYS:CURVE:STOP"}')])]),t._v(" "),s("td",[s("code",[t._v('{"res": "SYS:CURVE:STOP"}')])]),t._v(" "),s("td",[t._v("不会立即停止，会在扫完当前6MHz范围后不再进行下一段扫频")])]),t._v(" "),s("tr",[s("td",[t._v("软件重置AD9910")]),t._v(" "),s("td",[s("code",[t._v("/ctr/")])]),t._v(" "),s("td",[t._v("POST")]),t._v(" "),s("td",[s("code",[t._v('{"text": "SYS:RESET"}')])]),t._v(" "),s("td",[s("code",[t._v('{"res": "SYS:RESET"}')])]),t._v(" "),s("td")])])]),t._v(" "),s("p",[s("strong",[t._v("备注：")])]),t._v(" "),s("ol",[s("li",[s("p",[t._v("请求路径为"),s("code",[t._v("/test/")]),t._v("表示该请求的实际请求地址为"),s("code",[t._v("http://127.0.0.1:56789/test/")])])]),t._v(" "),s("li",[s("p",[t._v("请求类型为"),s("code",[t._v("POST")]),t._v("的请求体需要用"),s("code",[t._v("json.dumps")]),t._v("编码")])]),t._v(" "),s("li",[s("p",[t._v("所有调用因为网络原因不成功的，均可以用"),s("code",[t._v("response.status_code != 200")]),t._v("判断")])]),t._v(" "),s("li",[s("p",[t._v("（强烈建议）使用"),s("code",[t._v("client_web.py")]),t._v("封装好的接口进行接口调用")])]),t._v(" "),s("li",[s("p",[t._v("（建议）使用虚拟环境运行代码，参考"),s("RouterLink",{attrs:{to:"/blogs/note/python/2024-07-31.html"}},[t._v("python虚拟环境配置")])],1)])])])}),[],!1,null,null,null);_.default=a.exports}}]);